-- 테이블 순서는 관계를 고려하여 한 번에 실행해도 에러가 발생하지 않게 정렬되었습니다.

-- CHANNEL_CONTENTS Table Create SQL
CREATE TABLE CHANNEL_CONTENTS
(
    CON_SEQ            NUMBER           NOT NULL, 
    CHAN_SEQ           NUMBER           NOT NULL, 
    G_FILE_SEQ         NUMBER           NULL, 
    D_FILE_SEQ         NUMBER           NULL, 
    CON_WRITER         VARCHAR2(30)     NULL, 
    CON_TITLE          VARCHAR2(100)    NULL, 
    CON_DESC           CLOB             NULL, 
    CON_PUBLIC_YN      VARCHAR2(1)      NULL, 
    CON_CREATE_DATE    DATE             NULL, 
    CONSTRAINT CHANNEL_CONTENTS_PK PRIMARY KEY (CON_SEQ)
)
/

CREATE SEQUENCE CHANNEL_CONTENTS_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER CHANNEL_CONTENTS_CON_SE_AI_TRG
BEFORE INSERT ON CHANNEL_CONTENTS 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT CHANNEL_CONTENTS_SEQ.NEXTVAL
    INTO: NEW.CON_SEQ
    FROM DUAL;
END;
/


-- CHANNEL_INFO Table Create SQL
CREATE TABLE CHANNEL_INFO
(
    CHAN_SEQ            NUMBER          NOT NULL, 
    CA_URL              VARCHAR2(30)    NOT NULL, 
    USER_SEQ            NUMBER          NOT NULL, 
    CHAN_NAME           VARCHAR2(30)    NULL, 
    CHAN_CREATE_DATE    DATE            NULL, 
    CHAN_PUBLIC_YN      VARCHAR2(1)     NULL, 
    CHAN_TOPIC          VARCHAR2(50)    NULL, 
    CONSTRAINT CHANNEL_INFO_PK PRIMARY KEY (CHAN_SEQ)
)
/

CREATE SEQUENCE CHANNEL_INFO_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER CHANNEL_INFO_CHAN_SEQ_AI_TRG
BEFORE INSERT ON CHANNEL_INFO 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT CHANNEL_INFO_SEQ.NEXTVAL
    INTO: NEW.CHAN_SEQ
    FROM DUAL;
END;
/

ALTER TABLE CHANNEL_INFO
    ADD CONSTRAINT FK_CHANNEL_INFO_CHAN_SEQ_CHANN FOREIGN KEY (CHAN_SEQ)
        REFERENCES CHANNEL_CONTENTS (CHAN_SEQ)
/


-- CAFE_INFO Table Create SQL
CREATE TABLE CAFE_INFO
(
    CA_SEQ            NUMBER           NOT NULL, 
    USER_SEQ          NUMBER           NOT NULL, 
    CATE_SEQ          NUMBER           NULL, 
    CA_URL            VARCHAR2(30)     NOT NULL, 
    CA_NANE           VARCHAR2(30)     NULL, 
    CA_PUBLIC_YN      VARCHAR2(1)      NULL, 
    CA_TAG            VARCHAR2(100)    NULL, 
    CA_CREATE_DATE    DATE             NULL, 
    CA_TOPIC          VARCHAR2(50)     NULL, 
    CA_DESC           CLOB             NULL, 
    CA_IMG            VARCHAR2(50)     NULL, 
    CONSTRAINT CAFE_INFO_PK PRIMARY KEY (CA_SEQ)
)
/

CREATE SEQUENCE CAFE_INFO_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER CAFE_INFO_CA_SEQ_AI_TRG
BEFORE INSERT ON CAFE_INFO 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT CAFE_INFO_SEQ.NEXTVAL
    INTO: NEW.CA_SEQ
    FROM DUAL;
END;
/

ALTER TABLE CAFE_INFO
    ADD CONSTRAINT FK_CAFE_INFO_CA_URL_CHANNEL_IN FOREIGN KEY (CA_URL)
        REFERENCES CHANNEL_INFO (CA_URL)
/

ALTER TABLE CAFE_INFO
    ADD CONSTRAINT FK_CAFE_INFO_USER_SEQ_CHANNEL_ FOREIGN KEY (USER_SEQ)
        REFERENCES CHANNEL_INFO (USER_SEQ)
/


-- USER_INFO Table Create SQL
CREATE TABLE USER_INFO
(
    USER_SEQ           NUMBER          NOT NULL, 
    USER_NAME          VARCHAR2(30)    NULL, 
    USER_EMAIL         VARCHAR2(30)    NOT NULL, 
    USER_GENDER        VARCHAR2(5)     NULL, 
    USER_BIRTH         DATE            NULL, 
    USER_JOB           VARCHAR2(30)    NULL, 
    USER_TAG           VARCHAR2(50)    NULL, 
    USER_AREA          VARCHAR2(30)    NULL, 
    USER_CREAT_DATE    DATE            NULL, 
    CONSTRAINT USER_INFO_PK PRIMARY KEY (USER_SEQ)
)
/

CREATE SEQUENCE USER_INFO_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER USER_INFO_USER_SEQ_AI_TRG
BEFORE INSERT ON USER_INFO 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT USER_INFO_SEQ.NEXTVAL
    INTO: NEW.USER_SEQ
    FROM DUAL;
END;
/

ALTER TABLE USER_INFO
    ADD CONSTRAINT FK_USER_INFO_USER_SEQ_CAFE_INF FOREIGN KEY (USER_SEQ)
        REFERENCES CAFE_INFO (USER_SEQ)
/


-- GENERAL_FILE Table Create SQL
CREATE TABLE GENERAL_FILE
(
    G_FILE_SEQ     NUMBER           NOT NULL, 
    G_FILE_TYPE    VARCHAR2(10)     NULL, 
    G_FILE_SIZE    VARCHAR2(100)    NULL, 
    G_FILE_NAME    VARCHAR2(30)     NULL, 
    CONSTRAINT GENERAL_FILE_PK PRIMARY KEY (G_FILE_SEQ)
)
/

CREATE SEQUENCE GENERAL_FILE_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER GENERAL_FILE_G_FILE_SEQ_AI_TRG
BEFORE INSERT ON GENERAL_FILE 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT GENERAL_FILE_SEQ.NEXTVAL
    INTO: NEW.G_FILE_SEQ
    FROM DUAL;
END;
/

ALTER TABLE GENERAL_FILE
    ADD CONSTRAINT FK_GENERAL_FILE_G_FILE_SEQ_CHA FOREIGN KEY (G_FILE_SEQ)
        REFERENCES CHANNEL_CONTENTS (G_FILE_SEQ)
/


-- DOWNLOAD_FILE Table Create SQL
CREATE TABLE DOWNLOAD_FILE
(
    D_FILE_SEQ     NUMBER           NOT NULL, 
    D_FILE_TYPE    VARCHAR2(10)     NULL, 
    D_FILE_SIZE    VARCHAR2(100)    NULL, 
    D_FILE_NAME    VARCHAR2(30)     NULL, 
    CONSTRAINT DOWNLOAD_FILE_PK PRIMARY KEY (D_FILE_SEQ)
)
/

CREATE SEQUENCE DOWNLOAD_FILE_SEQ
START WITH 1
INCREMENT BY 1;
/

CREATE OR REPLACE TRIGGER DOWNLOAD_FILE_D_FILE_SE_AI_TRG
BEFORE INSERT ON DOWNLOAD_FILE 
REFERENCING NEW AS NEW FOR EACH ROW 
BEGIN 
    SELECT DOWNLOAD_FILE_SEQ.NEXTVAL
    INTO: NEW.D_FILE_SEQ
    FROM DUAL;
END;
/

ALTER TABLE DOWNLOAD_FILE
    ADD CONSTRAINT FK_DOWNLOAD_FILE_D_FILE_SEQ_CH FOREIGN KEY (D_FILE_SEQ)
        REFERENCES CHANNEL_CONTENTS (D_FILE_SEQ)
/



/
CREATE TABLE COMMON_CODE
(
    COM_ID                  VARCHAR2(10)           NOT NULL,
    COM_PARENT_ID           VARCHAR2(10)           NULL,
    COM_VALUE               VARCHAR2(50)           NULL,
    COM_COMMENT             VARCHAR2(100)          NULL,
    CONSTRAINT COM_ID_PK PRIMARY KEY (COM_ID)
);
/